# Install Linux on Windows with WSL

### Step 1 - Enable the Windows Subsystem for Linux

```powershell
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
```

### Step 2 - Check requirements for running WSL 2

To update to WSL 2, you must be running Windows 10...
For x64 systems: Version 1903 or later, with Build 18362 or later.
For ARM64 systems: Version 2004 or later, with Build 19041 or later.
or Windows 11.

### Step 3 - Enable Virtual Machine feature

```powershell
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

### Step 4 - Download the Linux kernel update package

<https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi>

```bat
dotnet new console -lang "F#"
```

### Step 5 - Set WSL 2 as your default version

```powershell
wsl --set-default-version 2
```

* Enable virtualization engine on physical or virtual machine

  * In physical enable virtualization in BIOS

  * In vmware settings enable virtualization engine

### Install distro

List available distro

```powershell
wsl --list --online
```

#### Install linux distro

```powershell
wsl --install -d Ubuntu
```

#### update linux

```bash
sudo apt-get update
```

upgrade linux

```bash
sudo apt-get upgrade
```

## NETWORK

wsl adds a network interface called vEthernet (WSL)

To obtain the IP address, use:

* for the IP address of your Linux distribution installed via WSL 2 (the WSL 2 VM address)

```powershell
wsl hostname -i

output
127.0.40.43
```

* for the IP address of the Windows machine as seen from WSL 2 (the WSL 2 VM)

```bash
cat /etc/resolv.conf

output
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf
# [network]
# generateResolvConf = false

nameserver 128.4.12.1
```

* Obtaining wsl ip address from windows

```powershell
get-netIPConfiguration  -InterfaceAlias *wsl*

//sample output
InterfaceAlias       : vEthernet (WSL)
InterfaceIndex       : 48
InterfaceDescription : Hyper-V Virtual Ethernet Adapter
IPv4Address          : 128.4.12.1
IPv6DefaultGateway   :
IPv4DefaultGateway   :
DNSServer            :
```

### (optional) Firewall rules

Create Inbound Rule
```powershell
New-NetFirewallRule -DisplayName "WSL" -Direction Inbound  -InterfaceAlias "vEthernet (WSL)"  -Action Allow
```

Create outbound Rule
```powershell
New-NetFirewallRule -DisplayName "WSL" -Direction Outbound  -InterfaceAlias "vEthernet (WSL)"  -Action Allow
```

check firewall rule
```powershell
Get-NetFirewallRule  | where DisplayName -ILike "*WSL*"
```

Remove Firewall rule
```powershell
Get-NetFirewallRule  | where DisplayName -ILike "*WSL*" | Remove-NetFirewallRule
```